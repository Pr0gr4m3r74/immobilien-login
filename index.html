<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login – Geschützter Bereich</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="box">
  <h2>Geschützter Kundenbereich</h2>
  <p>Bitte Passwort eingeben, um exklusive Wohnungsangebote zu sehen.</p>
  <input type="password" id="pw" placeholder="Passwort">
  <button onclick="login()">Login</button>
  <p id="msg" class="error"></p>
</div>
<script>
// Password is stored as SHA-256 hash (hashed value of "1234Test")
// This prevents the password from being visible in plain text
const PASS_HASH = "0d214e3d94bb80f70deffda9bd7a530fb8369e4d6e0586e13348eb4cfa7d9a52";
const COOLDOWN = 1000;
let lastTry = 0;

// SHA-256 hashing function
async function hashPassword(password) {
    const msgBuffer = new TextEncoder().encode(password);
    const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    return hashHex;
}

async function login() {
    const now = Date.now();
    if (now - lastTry < COOLDOWN) {
        document.getElementById("msg").textContent = "Bitte 1 Sekunde warten...";
        return;
    }
    lastTry = now;
    const val = document.getElementById("pw").value;
    const hashedInput = await hashPassword(val);
    
    if (hashedInput === PASS_HASH) {
        sessionStorage.setItem("access", Date.now());
        window.location.href = "geheim.html";
    } else {
        document.getElementById("msg").textContent = "Falsches Passwort";
    }
}
</script>
</body>
</html>
